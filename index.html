<html>
<meta name="viewport" content="initial-scale = 1.0,maximum-scale = 1.0" />
<head>
<title>Buttons</title>
</head>

<body bgcolor="green">
<!--
<p align = "center">
<table border=0 width="80%" height="60%">
<tr><td></td><td class = "up" id="up" onclick="clickHandler('up');"></tr>
<tr><td class="up" id="left" onclick="clickHandler('left');" ontouchstart="clickHandler('left');"></td><td></td><td id="right" onclick="clickHandler('right');" ontouchstart="clickHandler('right');" class="up"></td><td></td>
  <td class="up" id="b1" onclick="clickHandler('b1');" ontouchstart="clickHandler('b1');"></td><td class="up" id="b2" ontouchstart="clickHandler('b2');" onclick="clickHandler('b2');"></td><td class="up" id="b3" onclick="clickHandler('b3');" ontouchstart="clickHandler('b3');"></td></tr>
<tr><td></td><td class="up" id="down" onclick="clickHandler('down');" ontouchstart="clickHandler('down');"></td><td></td><td></td><td class="up" id="b4" onclick="clickHandler('b4');" ontouchstart="clickHandler('b4');"></tr>
</table>
</p>
-->

<canvas id="canvas" width="640" height="480"></canvas>

<!--<script src="/socket.io/socket.io.js"></script>-->
<script>

  var socket = io();

  var clickHandler = function(val) {
    socket.emit('clicked', {button: val});
  };

  var toggle = function(node, val) {
    node.className = val;
  };

  var right, left, up, down, b1, b2, b3, b4;
  right = left = up = down = b1 = b2 = b3 = b4 = 0;

  var onstyle = '#FFA500';
  var offstyle = '#BBBBBB';

  socket.on('right', function(data) {
    right = data.v;
  });
  socket.on('left', function(data) {
    left = data.v;
  });
  socket.on('up', function(data) {
    up = data.v;
  });
  socket.on('down', function(data) {
    down = data.v;
  });
  socket.on('b1', function(data) {
    b1 = data.v;
  });
  socket.on('b2', function(data) {
    b2 = data.v;
  });
  socket.on('b3', function(data) {
    b3 = data.v;
  });
  socket.on('b4', function(data) {
    b4 = data.v;
  });

  function draw() {
    var ctx = document.getElementById('canvas').getContext('2d');

    // joystick center
    ctx.beginPath();
    ctx.arc(120, 120, 45, 0, Math.PI * 2, 0);
    ctx.fill();


    // left
    ctx.strokeStyle = (left) ? onStyle : offStyle;
    ctx.beginPath();
    ctx.moveTo(30, 120);
    ctx.lineTo(70, 80);
    ctx.lineTo(70, 160);
    ctx.fill();

    // right
    ctx.strokeStyle = (right) ? onStyle : offStyle;
    ctx.beginPath();
    ctx.moveTo(170, 80);
    ctx.lineTo(170, 160);
    ctx.lineTo(210, 120);
    ctx.fill();

    // up
    ctx.strokeStyle = (up) ? onStyle : offStyle;
    ctx.beginPath();
    ctx.moveTo(80, 70);
    ctx.lineTo(160, 70);
    ctx.lineTo(120, 30);
    ctx.fill();

    // down
    ctx.strokeStyle = (down) ? onStyle : offStyle;
    ctx.beginPath();
    ctx.moveTo(80, 170);
    ctx.lineTo(160, 170);
    ctx.lineTo(120, 210);
    ctx.fill();

    // b1
    ctx.strokeStyle = (b1) ? onStyle : offStyle;
    ctx.beginPath();
    ctx.arc(270, 80, 35, 0, Math.PI * 2, 0);
    ctx.fill();

    // b2
    ctx.strokeStyle = (b2) ? onStyle : offStyle;
    ctx.beginPath();
    ctx.arc(340, 40, 35, 0, Math.PI * 2, 0);
    ctx.fill();

    // b3
    ctx.strokeStyle = (b3) ? onStyle : offStyle;
    ctx.beginPath();
    ctx.arc(420, 50, 35, 0, Math.PI * 2, 0);
    ctx.fill();

    // b4
    ctx.strokeStyle = (b4) ? onStyle : offStyle;
    ctx.beginPath();
    ctx.arc(260, 170, 35, 0, Math.PI * 2, 0);
    ctx.fill();

/*
    // b5
    ctx.beginPath();
    ctx.arc(332, 130, 35, 0, Math.PI * 2, 0);
    ctx.fill();
    
    // b6
    ctx.beginPath();
    ctx.arc(410, 140, 35, 0, Math.PI * 2, 0);
    ctx.fill();
    */
  }
  draw();
</script>
</body>
</html>
